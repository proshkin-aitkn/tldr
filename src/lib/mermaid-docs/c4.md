# C4 Diagram

**Declaration:** `C4Context`, `C4Container`, `C4Component`, `C4Dynamic`, or `C4Deployment`

> Note: C4 diagrams are experimental. Syntax may change in future releases.

## Supported Chart Types

1. **C4Context** - System context (high-level overview)
2. **C4Container** - Container diagram (system decomposition)
3. **C4Component** - Component diagram (internal structure)
4. **C4Dynamic** - Dynamic diagram (interaction sequences)
5. **C4Deployment** - Deployment diagram (infrastructure)

## System Context Elements

```
C4Context
    Person(customerA, "Customer A", "A customer of the system")
    Person_Ext(customerB, "Customer B", "External customer")

    System(systemA, "System A", "Main system")
    System_Ext(systemB, "System B", "External system")
    SystemDb(dbA, "Database A", "Stores data")
    SystemQueue(queueA, "Queue A", "Message queue")

    Enterprise_Boundary(eb, "Enterprise") {
        System(internalA, "Internal System", "Description")
    }

    Rel(customerA, systemA, "Uses", "HTTPS")
    Rel(systemA, dbA, "Reads/Writes")
```

### Person Elements
- `Person(alias, label, ?descr, ?sprite, ?tags, $link)`
- `Person_Ext` - External person

### System Elements
- `System(alias, label, ?descr, ?sprite, ?tags, $link)`
- `SystemDb`, `SystemQueue`
- `System_Ext`, `SystemDb_Ext`, `SystemQueue_Ext`

### Boundaries
- `Boundary(alias, label, ?type, ?tags, $link)`
- `Enterprise_Boundary(alias, label)`
- `System_Boundary(alias, label)`

## Container Elements

```
C4Container
    Container(webapp, "Web App", "Java/Spring", "Delivers content")
    ContainerDb(db, "Database", "PostgreSQL", "Stores data")
    ContainerQueue(queue, "Message Queue", "RabbitMQ")
    Container_Ext(extApi, "External API", "REST")
    Container_Boundary(cb, "Container Group") {
        Container(svc, "Service", "Node.js")
    }
```

## Component Elements

```
C4Component
    Component(comp, "Component", "Technology", "Description")
    ComponentDb(compDb, "DB Component", "Technology")
    ComponentQueue(compQ, "Queue Component", "Technology")
    Component_Ext(extComp, "External", "Technology")
```

## Deployment Elements

```
C4Deployment
    Deployment_Node(dc, "Data Center", "Location") {
        Deployment_Node(server, "Server", "Ubuntu") {
            Container(app, "Application", "Java")
        }
    }
    Node(node1, "Node", "Type", "Description")
    Node_L(left, "Left Node")
    Node_R(right, "Right Node")
```

## Dynamic Diagram

```
C4Dynamic
    RelIndex(1, customerA, systemA, "Step 1")
    RelIndex(2, systemA, dbA, "Step 2")
```

## Relationships

```
Rel(from, to, label, ?techn, ?descr, ?sprite, ?tags, $link)
BiRel(from, to, label)           %% bidirectional
Rel_U(from, to, label)           %% upward (alias: Rel_Up)
Rel_D(from, to, label)           %% downward (alias: Rel_Down)
Rel_L(from, to, label)           %% leftward (alias: Rel_Left)
Rel_R(from, to, label)           %% rightward (alias: Rel_Right)
Rel_Back(from, to, label)
```

## Parameter Syntax

Positional:
```
UpdateRelStyle(customerA, bankA, "red", "blue", "-40", "60")
```

Named ($ prefix):
```
UpdateRelStyle(customerA, bankA, $offsetX="-40", $offsetY="60")
```

## Important: Boundaries vs Elements

Only these boundary types can contain `{ }` children:
- `Boundary(alias, label, ?type) { ... }` (generic)
- `Enterprise_Boundary(alias, label) { ... }`
- `System_Boundary(alias, label) { ... }`
- `Container_Boundary(alias, label) { ... }`

There is NO `Component_Boundary` — use `Container_Boundary` or `Boundary` to group components.

`Container()`, `Component()`, `System()`, etc. are leaf elements — do NOT add `{ }` blocks to them.

## Limitations

- Fixed CSS styling (doesn't change with skins)
- No fully automated layout (adjust by reordering statements)
- Sprite, tags, link, Legend not yet implemented
- Layout statements (Lay_U, Lay_D, etc.) not supported
